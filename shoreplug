#!/usr/bin/env bash
# shoreplug -- remotely power-cycle Shore's smart power socket
#
# Dependency: pip install python-kasa

host=10.4.240.4
#user=$(getnetrc -df %u tapo) || exit
#pass=$(getnetrc -df %p tapo) || exit
user=$(ad gp =Tapo :email) || exit
pass=$(ad gp =Tapo !pass) || exit

(( $# )) || set -- state

kasa --host "$host" \
	--username "$user" \
	--password "$pass" \
	--device-family SMART.TAPOPLUG \
	--encrypt-type KLAP \
	"$@"
