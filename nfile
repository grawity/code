#!/usr/bin/env bash
# nfile – output an unique filename ("date.nnn" or "prefix – date.nnn")

prefix="$1"
date=$(date +"%Y-%m-%d")
mprefix="${prefix:+$prefix – }"
dir="."

for (( count=0; count < 999; count++ )); do
	printf -v name "%s%s.%03d.png" "$mprefix" "$date" "$count"
	[[ ! -e $dir/$name && ! -e $dir/.$name.tmp ]] && break
done

echo "$dir/$name"
