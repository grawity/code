#!/usr/bin/env python3
# testcidr -- check whether a host is within a network prefix
import argparse
import ipaddress
import os

parser = argparse.ArgumentParser()
parser.add_argument("host", type=ipaddress.ip_address)
parser.add_argument("network", type=ipaddress.ip_network)
args = parser.parse_args()

if args.host.version != args.net.version:
    exit("error: mismatching address versions")

exit(0 if args.host in args.net else 1)
