#!/usr/bin/env bash
for ifp in /sys/class/net/*; do
	if=${ifp##*/}
	[[ $(< $ifp/carrier) == 1 ]] || continue
	[[ $(< $ifp/operstate) == up ]] || continue
	nstate=$(nmcli -t -f general.state dev show $if \
		 | sed 's/[^:]*://; s/[0-9]* (\(.*\))/\1/')
	[[ $nstate == unmanaged ]] && exit 2
	[[ $nstate == connected ]] && exit 0
done
exit 1
