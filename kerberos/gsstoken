#!/usr/bin/env python3
import argparse
import base64
import gssapi

def b64encode(buf):
    return base64.b64encode(buf).decode()

parser = argparse.ArgumentParser()
parser.add_argument("-i", "--initiate",
                    action="store_true",
                    help="Run as client (initiator)")
parser.add_argument("-n", "--service-name",
                    required=True,
                    help="Target GSS name (service or service@host)")
args = parser.parse_args()

service_name = gssapi.Name(args.service_name,
                           gssapi.NameType.hostbased_service)

context = gssapi.SecurityContext(usage="initiate",
                                 name=service_name)

out_token = context.step()

print(b64encode(out_token))
